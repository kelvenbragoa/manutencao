import{_ as E,u as q,h as I,y as T,r as M,z as k,j as H,c as l,a as c,b as s,e as S,t as i,f as r,x as b,F as N,l as U,m as h,g as j}from"./app-CkKbduy8.js";import{h as n}from"./moment-BLMuvzoS.js";const B={key:0,class:"vh-100 d-flex justify-content-center align-items-center"},F={key:1,class:"container-fluid py-4"},L={class:"row mb-4"},V={class:"col-12"},O={class:"d-flex justify-content-between align-items-center"},R={class:"h3 mb-1"},G={"aria-label":"breadcrumb"},J={class:"breadcrumb mb-0"},K={class:"breadcrumb-item active"},P={class:"row mb-4"},Q={class:"col-md-4"},W={class:"card border-0 shadow-sm"},X={class:"card-body"},Z={class:"d-flex align-items-center"},ss={class:"mb-1"},ts={class:"text-muted"},es={class:"col-md-4"},as={class:"card border-0 shadow-sm"},is={class:"card-body"},os={class:"d-flex align-items-center"},ns={class:"col-md-4"},ds={class:"card border-0 shadow-sm"},rs={class:"card-body"},ls={class:"d-flex align-items-center"},cs={class:"mb-0 h5"},ms={class:"row"},us={class:"col-12"},_s={class:"card border-0 shadow-sm"},vs={class:"card-body"},bs={class:"timeline"},hs={class:"timeline-marker"},ps={class:"timeline-content"},fs={class:"card border-0 shadow-sm"},ys={class:"card-body"},gs={class:"d-flex justify-content-between align-items-start"},xs={class:"mb-1"},ws={class:"text-muted mb-2"},Ms={class:"text-muted mb-0"},ks={key:0,class:"text-end"},Ss={class:"badge badge-light"},$s={key:0,class:"row mt-4"},Ys={class:"col-12"},zs={class:"card border-0 shadow-sm"},Cs={class:"card-body"},Ds={class:"mb-0"},As={class:"row mt-4"},Es={class:"col-12"},qs={class:"card border-0 shadow-sm"},Is={class:"card-body"},Ts={class:"row"},Hs={class:"col-md-4"},Ns={class:"text-muted"},Us={class:"col-md-4"},js={class:"text-muted"},Bs={class:"col-md-4"},Fs={class:"text-muted"},Ls={__name:"ShowMovement",setup(Vs){n.locale("pt");const $=q(),p=I(),Y=T(),f=M(!0),a=M(null),z=Y.params.id,C={1:"Aguarda Aprovação",2:"Aguardando Entrada",3:"Na Oficina",4:"Em Manutenção",5:"Em Inspeção",6:"Concluída",7:"Aguarda Saída",8:"Finalizada"},y={1:"warning",2:"info",3:"primary",4:"danger",5:"secondary",6:"success",7:"dark",8:"light"},d=(e,t=null)=>{if(!e)return null;const o=n(e),m=t?n(t):n(),u=n.duration(m.diff(o)),w=Math.floor(u.asDays()),_=Math.floor(u.asHours()%24),v=Math.floor(u.asMinutes()%60);return w>0?`${w}d ${_}h ${v}m`:_>0?`${_}h ${v}m`:`${v}m`},g=k(()=>{if(!a.value)return[];const e=a.value,t=[];return e.entry_time&&t.push({status:1,title:"Entrada Solicitada",timestamp:e.entry_time,user:e.requested_by_user_id?`Usuário ${e.requested_by_user_id}`:"Sistema",duration:d(e.entry_time,e.approved_at)}),e.approved_at&&t.push({status:2,title:"Entrada Aprovada",timestamp:e.approved_at,user:e.approved_by_user_id?`Usuário ${e.approved_by_user_id}`:"Sistema",duration:d(e.approved_at,e.in_maintenance_at)}),e.in_maintenance_at&&t.push({status:3,title:"Iniciou Manutenção",timestamp:e.in_maintenance_at,user:e.in_maintenance_by_user_id?`Usuário ${e.in_maintenance_by_user_id}`:"Sistema",duration:d(e.in_maintenance_at,e.maintenance_done_at)}),e.maintenance_done_at&&t.push({status:4,title:"Manutenção Concluída",timestamp:e.maintenance_done_at,user:e.maintenance_done_by_user_id?`Usuário ${e.maintenance_done_by_user_id}`:"Sistema",duration:d(e.maintenance_done_at,e.inspection_at)}),e.inspection_at&&t.push({status:5,title:"Em Inspeção",timestamp:e.inspection_at,user:e.inspection_done_by_user_id?`Usuário ${e.inspection_done_by_user_id}`:"Sistema",duration:d(e.inspection_at,e.authorized_exit_at)}),e.authorized_exit_at&&t.push({status:6,title:"Saída Autorizada",timestamp:e.authorized_exit_at,user:e.authorized_exit_by_user_id?`Usuário ${e.authorized_exit_by_user_id}`:"Sistema",duration:d(e.authorized_exit_at,e.exit_time)}),e.exit_time&&t.push({status:8,title:"Saída Concluída",timestamp:e.exit_time,user:e.exit_by_user_id?`Usuário ${e.exit_by_user_id}`:"Sistema",duration:null}),t}),D=k(()=>{if(!a.value||!a.value.entry_time)return null;const e=a.value.exit_time||new Date;return d(a.value.entry_time,e)}),A=async()=>{try{const e=await j.get(`/api/entrymovement/${z}`);a.value=e.data,f.value=!1}catch{$.error("Erro ao carregar dados do movimento"),p.back()}},x=()=>{p.back()};return H(()=>{A()}),(e,t)=>f.value?(c(),l("div",B,t[0]||(t[0]=[s("div",{class:"spinner-border text-primary",role:"status",style:{width:"3rem",height:"3rem"}},[s("span",{class:"sr-only"},"Loading...")],-1)]))):(c(),l("div",F,[s("div",L,[s("div",V,[s("div",O,[s("div",null,[s("h2",R,"Detalhes do Movimento #"+i(a.value.id),1),s("nav",G,[s("ol",J,[s("li",{class:"breadcrumb-item"},[s("a",{href:"#",onClick:x},"Movimentos")]),s("li",K,"Movimento #"+i(a.value.id),1)])])]),s("button",{class:"btn btn-outline-secondary",onClick:x},t[1]||(t[1]=[s("i",{class:"fe fe-arrow-left me-2"},null,-1),r("Voltar ",-1)]))])])]),s("div",P,[s("div",Q,[s("div",W,[s("div",X,[s("div",Z,[t[3]||(t[3]=s("div",{class:"avatar avatar-lg bg-primary text-white rounded-circle me-3"},[s("i",{class:"fe fe-truck"})],-1)),s("div",null,[t[2]||(t[2]=s("h6",{class:"card-title mb-1"},"Equipamento",-1)),s("p",ss,[s("strong",null,i(a.value.equipment?.name||"N/A"),1)]),s("small",ts,"Frota: "+i(a.value.equipment?.fleet?.name||"N/A"),1)])])])])]),s("div",es,[s("div",as,[s("div",is,[s("div",os,[t[5]||(t[5]=s("div",{class:"avatar avatar-lg bg-success text-white rounded-circle me-3"},[s("i",{class:"fe fe-activity"})],-1)),s("div",null,[t[4]||(t[4]=s("h6",{class:"card-title mb-1"},"Status Atual",-1)),s("span",{class:b(`badge badge-${y[a.value.equipment_movement_status_id]} badge-lg`)},i(C[a.value.equipment_movement_status_id]),3)])])])])]),s("div",ns,[s("div",ds,[s("div",rs,[s("div",ls,[t[8]||(t[8]=s("div",{class:"avatar avatar-lg bg-warning text-white rounded-circle me-3"},[s("i",{class:"fe fe-clock"})],-1)),s("div",null,[t[6]||(t[6]=s("h6",{class:"card-title mb-1"},"Tempo Total",-1)),s("p",cs,i(D.value||"Calculando..."),1),t[7]||(t[7]=s("small",{class:"text-muted"},"No sistema",-1))])])])])])]),s("div",ms,[s("div",us,[s("div",_s,[t[13]||(t[13]=s("div",{class:"card-header bg-white border-bottom-0"},[s("h5",{class:"card-title mb-0"},[s("i",{class:"fe fe-clock me-2"}),r("Timeline do Movimento ")])],-1)),s("div",vs,[s("div",bs,[(c(!0),l(N,null,U(g.value,(o,m)=>(c(),l("div",{key:m,class:b(["timeline-item",{"timeline-item-last":m===g.value.length-1}])},[s("div",hs,[s("div",{class:b(`timeline-marker-icon bg-${y[o.status]} text-white`)},t[9]||(t[9]=[s("i",{class:"fe fe-check"},null,-1)]),2)]),s("div",ps,[s("div",fs,[s("div",ys,[s("div",gs,[s("div",null,[s("h6",xs,i(o.title),1),s("p",ws,[t[10]||(t[10]=s("i",{class:"fe fe-calendar me-1"},null,-1)),r(" "+i(h(n)(o.timestamp).format("DD/MM/YYYY HH:mm")),1)]),s("p",Ms,[t[11]||(t[11]=s("i",{class:"fe fe-user me-1"},null,-1)),r(i(o.user),1)])]),o.duration?(c(),l("div",ks,[s("span",Ss,[t[12]||(t[12]=s("i",{class:"fe fe-clock me-1"},null,-1)),r(i(o.duration),1)])])):S("",!0)])])])])],2))),128))])])])])]),a.value.observation?(c(),l("div",$s,[s("div",Ys,[s("div",zs,[t[14]||(t[14]=s("div",{class:"card-header bg-white border-bottom-0"},[s("h5",{class:"card-title mb-0"},[s("i",{class:"fe fe-message-square me-2"}),r("Observações ")])],-1)),s("div",Cs,[s("p",Ds,i(a.value.observation),1)])])])])):S("",!0),s("div",As,[s("div",Es,[s("div",qs,[t[18]||(t[18]=s("div",{class:"card-header bg-white border-bottom-0"},[s("h5",{class:"card-title mb-0"},[s("i",{class:"fe fe-info me-2"}),r("Informações Técnicas ")])],-1)),s("div",Is,[s("div",Ts,[s("div",Hs,[t[15]||(t[15]=s("p",{class:"mb-1"},[s("strong",null,"ID do Movimento:")],-1)),s("p",Ns,i(a.value.id),1)]),s("div",Us,[t[16]||(t[16]=s("p",{class:"mb-1"},[s("strong",null,"Criado em:")],-1)),s("p",js,i(h(n)(a.value.created_at).format("DD/MM/YYYY HH:mm")),1)]),s("div",Bs,[t[17]||(t[17]=s("p",{class:"mb-1"},[s("strong",null,"Última atualização:")],-1)),s("p",Fs,i(h(n)(a.value.updated_at).format("DD/MM/YYYY HH:mm")),1)])])])])])])]))}},Gs=E(Ls,[["__scopeId","data-v-18109db2"]]);export{Gs as default};
